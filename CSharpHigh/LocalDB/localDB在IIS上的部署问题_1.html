<!DOCTYPE html>
<html lang="en-US">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width">
	<link rel="profile" href="http://gmpg.org/xfn/11">
	<link rel="stylesheet" href="https://ajax.aspnetcdn.com/ajax/bootstrap/3.3.5/css/bootstrap.min.css">
	<link rel="pingback" href="https://blogs.msdn.microsoft.com/sqlexpress/xmlrpc.php">
		<!--[if lt IE 9]>
	<script src="https://blogs.msdn.microsoft.com/sqlexpress/wp-content/themes/microsoft/js/html5.js"></script>
	<![endif]-->
	    <link rel="shortcut icon" href="https://blogs.msdn.microsoft.com/sqlexpress/wp-content/themes/microsoft-msdn/images/favicon-msdn.png">
<title>Using LocalDB with Full IIS, Part 1: User Profile &#8211; SQL Server Express WebLog</title>
<link rel='dns-prefetch' href='//ajax.aspnetcdn.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="SQL Server Express WebLog &raquo; Using LocalDB with Full IIS, Part 1: User Profile Comments Feed" href="https://blogs.msdn.microsoft.com/sqlexpress/2011/12/08/using-localdb-with-full-iis-part-1-user-profile/feed/" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/11\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/11\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/blogs.msdn.microsoft.com\/sqlexpress\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.9.10"}};
			!function(a,b,c){function d(a,b){var c=String.fromCharCode;l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,a),0,0);var d=k.toDataURL();l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,b),0,0);var e=k.toDataURL();return d===e}function e(a){var b;if(!l||!l.fillText)return!1;switch(l.textBaseline="top",l.font="600 32px Arial",a){case"flag":return!(b=d([55356,56826,55356,56819],[55356,56826,8203,55356,56819]))&&(b=d([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]),!b);case"emoji":return b=d([55358,56760,9792,65039],[55358,56760,8203,9792,65039]),!b}return!1}function f(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var g,h,i,j,k=b.createElement("canvas"),l=k.getContext&&k.getContext("2d");for(j=Array("flag","emoji"),c.supports={everything:!0,everythingExceptFlag:!0},i=0;i<j.length;i++)c.supports[j[i]]=e(j[i]),c.supports.everything=c.supports.everything&&c.supports[j[i]],"flag"!==j[i]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[j[i]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(h=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",h,!1),a.addEventListener("load",h,!1)):(a.attachEvent("onload",h),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),g=c.source||{},g.concatemoji?f(g.concatemoji):g.wpemoji&&g.twemoji&&(f(g.twemoji),f(g.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel='stylesheet' id='wds-ratings-css'  href='https://blogs.msdn.microsoft.com/sqlexpress/wp-content/plugins/wds-ratings/wds-ratings.css?ver=20161014' type='text/css' media='all' />
<link rel='stylesheet' id='microsoft-parent-style-css'  href='https://blogs.msdn.microsoft.com/sqlexpress/wp-content/themes/microsoft/style.css?ver=02092017' type='text/css' media='all' />
<link rel='stylesheet' id='microsoft-child-style-css'  href='https://blogs.msdn.microsoft.com/sqlexpress/wp-content/themes/microsoft-msdn/style.css?ver=04152016' type='text/css' media='all' />
<script type='text/javascript' src='https://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.12.1.min.js'></script>
<script type='text/javascript' src='https://ajax.aspnetcdn.com/ajax/bootstrap/3.3.5/bootstrap.min.js'></script>
<script type='text/javascript' src='https://blogs.msdn.microsoft.com/sqlexpress/wp-content/themes/microsoft/js/single.js?ver=02092017'></script>
<link rel='https://api.w.org/' href='https://blogs.msdn.microsoft.com/sqlexpress/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://blogs.msdn.microsoft.com/sqlexpress/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://blogs.msdn.microsoft.com/sqlexpress/wp-includes/wlwmanifest.xml" /> 

<link rel="canonical" href="https://blogs.msdn.microsoft.com/sqlexpress/2011/12/08/using-localdb-with-full-iis-part-1-user-profile/" />
<link rel='shortlink' href='https://blogs.msdn.microsoft.com/sqlexpress/?p=144' />
<link rel="alternate" type="application/json+oembed" href="https://blogs.msdn.microsoft.com/sqlexpress/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fblogs.msdn.microsoft.com%2Fsqlexpress%2F2011%2F12%2F08%2Fusing-localdb-with-full-iis-part-1-user-profile%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://blogs.msdn.microsoft.com/sqlexpress/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fblogs.msdn.microsoft.com%2Fsqlexpress%2F2011%2F12%2F08%2Fusing-localdb-with-full-iis-part-1-user-profile%2F&#038;format=xml" />
	<script>
		if(window.document.referrer.indexOf('login.live.com') !== -1) {
			// redefine ga function to prevent referrer data collected by google analytics
			window.ga = function(){};
		}
	</script>
	<div id='msccBanner' dir='ltr' data-site-name='uhf-MSDNBlogs' data-mscc-version='0.4.1' data-nver='aspnet-3.1.3' data-sver='0.1.2' class='cc-banner' role='alert' aria-labelledby='msccMessage'><div class='cc-container'><svg class='cc-icon cc-v-center' x='0px' y='0px' viewBox='0 0 44 44' height='30px' fill='none' stroke='currentColor'><circle cx='22' cy='22' r='20' stroke-width='2'></circle><line x1='22' x2='22' y1='18' y2='33' stroke-width='3'></line><line x1='22' x2='22' y1='12' y2='15' stroke-width='3'></line></svg> <span id='msccMessage' class='cc-v-center cc-text' tabindex='0'>This site uses cookies for analytics, personalized content and ads. By continuing to browse this site, you agree to this use.</span> <a href='https://go.microsoft.com/fwlink/?linkid=845480' target='_top' aria-label='Learn more about Microsoft&#39;s Cookie Policy' id='msccLearnMore' class='cc-link cc-v-center cc-float-right' data-mscc-ic='false'>Learn more</a></div></div><script type="text/javascript">
jQuery( window ).load( function() {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    if (typeof mscc === 'undefined' || (!mscc || mscc.hasConsent())) {
                ga('require', 'linkid');
                ga('create', 'UA-65691138-1', 'auto');
                ga('send', 'pageview');
                ga('set', 'anonymizeIp', true);
            }
} );
</script>
			<!-- Begin Custom CSS --><style type="text/css" id="wds-custom-css">
						</style><!-- End Custom CSS -->
			<meta property="og:type" content="article" />
<meta property="og:title" content="Using LocalDB with Full IIS, Part 1: User Profile" />
<meta property="og:url" content="https://blogs.msdn.microsoft.com/sqlexpress/2011/12/08/using-localdb-with-full-iis-part-1-user-profile/" />
<meta property="og:site_name" content="SQL Server Express WebLog" />
<meta property="og:description" content="This is the first post in two-post mini-series on using LocalDB with Full IIS. If you found it useful make sure to continue to the second post. LocalDB and Full IIS In this recent post I described how to use SQL Server Express LocalDB with Visual Studio 2010. The approach I proposed works for all..." />
<meta property="og:image" content="https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/37/92/2011_2D00_12_2D00_08/0312.0.0_AspNetFailure.png" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="Using LocalDB with Full IIS, Part 1: User Profile" />
<meta name="twitter:url" content="https://blogs.msdn.microsoft.com/sqlexpress/2011/12/08/using-localdb-with-full-iis-part-1-user-profile/" />
<meta name="twitter:description" content="This is the first post in two-post mini-series on using LocalDB with Full IIS. If you found it useful make sure to continue to the second post. LocalDB and Full IIS In this recent post I described how to use SQL Server Express LocalDB with Visual Studio 2010. The approach I proposed works for all..." />
<meta name="twitter:image" content="https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/37/92/2011_2D00_12_2D00_08/0312.0.0_AspNetFailure.png" />
<style type="text/css" id="syntaxhighlighteranchor"></style>
</head>

<body class="post-template-default single single-post postid-144 single-format-standard">
<div id="page" class="site container-fluid">

	<header id="site-header" class="site-header row" role="banner">
		<div id="site-header-global-wrapper" class="site-header-global-wrapper">
			<div id="site-header-global" class="site-header-global">
				<button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#site-profile-menu" aria-label="toggle menu" tabindex="0" aria-expanded="false">
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
				</button>
				<div id="site-logo" class="col-sm-5 row navbar-header">
					<div id="header-microsoft-logo">
						<a id="home-link" href="https://www.microsoft.com/" tabindex="1" aria-label="Microsoft logo">
							<img id="header-microsoft-logo-svg" src="https://blogs.msdn.microsoft.com/sqlexpress/wp-content/themes/microsoft/images/ms-logo-gray.svg" alt="Microsoft logo">
							<span id="brand">
								<span id="brand-separator">|</span>
								<span id="brand-name"></span>
							</span>
						</a>
					</div>
				</div>
				<div id="site-header-global-right" class="col-sm-7">
					<div id="site-profile-menu" class="navbar-collapse collapse">
						<div id="search-form-wrapper">
														<form id="search-form" role="search" action="https://social.msdn.microsoft.com/search/en-US" home-url="https://blogs.msdn.microsoft.com/sqlexpress" autocomplete="off">
								<div class="input-group">
																			<input name="rq" value="site:blogs.msdn.microsoft.com/sqlexpress" type="hidden">
										<input name="rn" value="sqlexpress" type="hidden">
																		<input type="hidden" name="ral" value="1">
									<input type="text" class="form-control" placeholder="Search" name="query" id="srch-term" tabindex="0" aria-label="Search box with search options">
									<div class="input-group-btn">
										<button aria-label="Search" class="btn btn-default" type="submit"><i class="glyphicon glyphicon-search"></i></button>
									</div>
								</div>
							</form>
							<div id="search-option">
								<div class="search-filter" id="search-filter-site" tabindex="0" aria-label="Search MSDN">
									<span class="glyphicon glyphicon-ok" aria-hidden="true"></span>
									<span class="search-text">Search MSDN</span>
								</div>
								<div class="search-filter" tabindex="0" aria-label="Search all blogs" id="search-filter-all-blogs">
									<span class="glyphicon glyphicon-ok" aria-hidden="true"></span>
									<span class="search-text">Search all blogs</span>
								</div>
																	<div class="search-filter selected" tabindex="0" aria-label="Search this blog" id="search-filter-this-blog">
										<span class="glyphicon glyphicon-ok" aria-hidden="true"></span>
										<span class="search-text">Search this blog</span>
									</div>
															</div>
						</div>
						<div id="me-control">
															<a href="https://blogs.msdn.microsoft.com/wp-login.php?aadsso_action=login">Sign in</a>
													</div>
					</div>
				</div>

			</div>

		</div>
		<div id="site-header-blog-wrapper" class="site-header-blog-wrapper ms-blog-header clear-both">
			<div id="site-header-blog" class="site-header-blog">
				<nav class="navbar navbar-inverse">
					<div id="blog-logo-area" class="navbar-header">
						<div id="blog-logo" data-toggle="collapse" data-target="#blog-menu" tabindex="0" aria-label="blog logo">
														<div id="blog-logo-text">
				<h1 class="site-title ms-blog-title">
					<a href="https://blogs.msdn.microsoft.com/sqlexpress" class="for-desktop">
						SQL Server Express WebLog					</a>
					<a href="https://blogs.msdn.microsoft.com/sqlexpress" class="for-mobile">
						SQL Server Express WebLog					</a>
				</h1>
				<p class="site-description ms-blog-description"></p>
			</div>
									</div>
					</div>
									</nav>
			</div>
		</div>
		<div id="site-header-image-wrapper" class="ms-blog-banner">
			<div id="site-header-image">
											</div>
		</div>
	</header>

	<div id="site-content" class="site-content row">

	<div id="primary" class="content-area col-sm-9">
		<div id="single-content" class="div-content">

			
				
<article id="post-144" class="post-144 post type-post status-publish format-standard hentry category-uncategorized">

	<header class="entry-header single">
		<h1 class="entry-title">Using LocalDB with Full IIS, Part 1: User Profile</h1>		<div class="rating-wrap">
		<div id="star-rating-144" class="wds-ratings" data-rating="4" data-userrating="0" data-postid="144" data-container="body" data-toggle="tooltip" title="7 user(s) rated">
			<div class="wds-ratings-inner-wrap">
				<div>
					<div aria-label="Select 5 star, this article is 4 star rated" tabindex="0" class="wds-ratings-stars wds-ratings-stars-enable-editing" data-stars="5"><span aria-hidden="true" class="star-1"><span>&#x2605;</span></span><span aria-hidden="true" class="star-2"><span>&#x2605;</span></span><span aria-hidden="true" class="star-3"><span>&#x2605;</span></span><span aria-hidden="true" class="star-4"><span>&#x2605;</span></span><span aria-hidden="true" class="star-5"><span>&#x2605;</span></span></div><div aria-label="Select 4 star, this article is 4 star rated" tabindex="0" class="wds-ratings-stars wds-ratings-stars-enable-editing" data-stars="4"><span aria-hidden="true" class="star-1"><span>&#x2605;</span></span><span aria-hidden="true" class="star-2"><span>&#x2605;</span></span><span aria-hidden="true" class="star-3"><span>&#x2605;</span></span><span aria-hidden="true" class="star-4"><span>&#x2605;</span></span></div><div aria-label="Select 3 star, this article is 4 star rated" tabindex="0" class="wds-ratings-stars wds-ratings-stars-enable-editing" data-stars="3"><span aria-hidden="true" class="star-1"><span>&#x2605;</span></span><span aria-hidden="true" class="star-2"><span>&#x2605;</span></span><span aria-hidden="true" class="star-3"><span>&#x2605;</span></span></div><div aria-label="Select 2 star, this article is 4 star rated" tabindex="0" class="wds-ratings-stars wds-ratings-stars-enable-editing" data-stars="2"><span aria-hidden="true" class="star-1"><span>&#x2605;</span></span><span aria-hidden="true" class="star-2"><span>&#x2605;</span></span></div><div aria-label="Select 1 star, this article is 4 star rated" tabindex="0" class="wds-ratings-stars wds-ratings-stars-enable-editing" data-stars="1"><span aria-hidden="true" class="star-1"><span>&#x2605;</span></span></div>
				</div>
			</div>
		</div>
		</div>		<div class="clear-both"></div>
		<div class="entry-meta">
			<img alt='avatar of sqlexpress' src='https://i1.social.s-msft.com/profile/u/avatar.jpg?displayname=sqlexpress&size=extralarge&version=00000000-0000-0000-0000-000000000000'  class='avatar avatar-22 photo' height='22' width='22' /><span class="byline"><span class="author vcard"><a class="url fn n profile-usercard-hover" data-profile-userid="7e5e566b7eff425ea82b8a27b11ef65d" href="https://social.msdn.microsoft.com/profile/sqlexpress">sqlexpress</a></span></span><span class="posted-on posted-on-margin"><span class="screen-reader-text"></span><time class="entry-date published updated" datetime="2011-12-08T23:14:00+00:00">December 8, 2011</time></span><span class="comments-link"><span class="glyphicon glyphicon-comment" aria-hidden="true"></span><a href="https://blogs.msdn.microsoft.com/sqlexpress/2011/12/08/using-localdb-with-full-iis-part-1-user-profile/#comments">26</a></span>				<span class="social-icons-wrap">
		<ul class="social-icons">
			<li><div class="fb-share-button" data-href="https://blogs.msdn.microsoft.com/sqlexpress/2011/12/08/using-localdb-with-full-iis-part-1-user-profile/" data-layout="button_count" data-size="large" data-mobile-iframe="true"><a class="fb-xfbml-parse-ignore" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://blogs.msdn.microsoft.com/sqlexpress/2011/12/08/using-localdb-with-full-iis-part-1-user-profile/&amp;src=sdkpreparse">Share</a></div></li>
			<div id="fb-root" style="display:none"></div>

			<li class="social-icon twitter"><a data-social='{"type":"twitter", "url":"https://blogs.msdn.microsoft.com/sqlexpress/2011/12/08/using-localdb-with-full-iis-part-1-user-profile/", "text": "Using LocalDB with Full IIS, Part 1: User Profile"}' href="#" id="post_tweet_count">0</a></li>
			<li class="social-icon linkedin"><a data-social='{"type":"linkedin", "url":"https://blogs.msdn.microsoft.com/sqlexpress/2011/12/08/using-localdb-with-full-iis-part-1-user-profile/", "text": "Using LocalDB with Full IIS, Part 1: User Profile"}' href="#" id="get_post_linkedin_count">0</a></li>
		</ul>
	</span><!-- .social-icons-wrap -->
	<script type="text/javascript">
		// Get social counts
		jQuery( window ).load(function () {
			jQuery.getScript('https://blogs.msdn.microsoft.com/sqlexpress/wp-content/themes/microsoft/js/social-counts.js?ver=02092017')
				.done(function(script,textStatus) {
					window.msdnsocial.ajax('https://blogs.msdn.microsoft.com/sqlexpress/2011/12/08/using-localdb-with-full-iis-part-1-user-profile/');
				});
		});
	</script>
		</div>
		<hr>
	</header><!-- .entry-header -->

	<div class="entry-content single">
		<p>This is the first post in two-post mini-series on using LocalDB with Full IIS. If you found it useful make sure to continue to the <a href="http://blogs.msdn.com/b/sqlexpress/archive/2011/12/09/using-localdb-with-full-iis-part-2-instance-ownership.aspx">second post</a>.</p>
<h3>LocalDB and Full IIS</h3>
<p>In <a href="http://blogs.msdn.com/b/sqlexpress/archive/2011/11/28/using-localdb-in-visual-studio-2010.aspx">this recent post</a> I described how to use SQL Server Express LocalDB with Visual Studio 2010. The approach I proposed works for all kind of projects, including Web Applications. However, when it comes to Web Application, there is a catch. An application hosted in Cassini or IIS Express will work as expected, but as soon as we try running it in full IIS (the regular IIS that comes with Windows and runs as Windows service) we are facing the following error:</p>
<p><a href="https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/37/92/2011_2D00_12_2D00_08/0312.0.0_AspNetFailure.png" original-url="http://blogs.msdn.com/cfs-filesystemfile.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-00-37-92-2011_2D00_12_2D00_08/0312.0.0_5F00_AspNetFailure.png"><img style="max-width: 550px;" border="0" alt="" src="https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/37/92/2011_2D00_12_2D00_08/0312.0.0_AspNetFailure.png" original-url="http://blogs.msdn.com/cfs-filesystemfile.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-00-37-92-2011_2D00_12_2D00_08/0312.0.0_5F00_AspNetFailure.png" /></a></p>
<h3>What Went Wrong?</h3>
<p>There are two properties of LocalDB that cause problems when running under full IIS:</p>
<ul>
<li>LocalDB needs user profile to be loaded</li>
<li>LocalDB instance is owned by a single user and private (by default)</li>
</ul>
<p>We will focus the rest of this post on the user profile, leaving the issue of LocalDB instance ownership for the <a href="http://blogs.msdn.com/b/sqlexpress/archive/2011/12/09/using-localdb-with-full-iis-part-2-instance-ownership.aspx">next post</a>.</p>
<h3><a name="LoadProfile"></a>Loading User Profile</h3>
<p>Let's take another look at the error:</p>
<p style="margin: 20px; color: #800000;" color="#800000"><i><b>System.Data.SqlClient.SqlException:</b> A network-related or instance-specific error occurred while establishing a connection to SQL Server. The server was not found or was not accessible. Verify that the instance name is correct and that SQL Server is configured to allow remote connections. (provider: SQL Network Interfaces, error: 0 - [x89C50120])</i></p>
<p>The error message is not very helpful but LocalDB stores additional information in Windows Event Log. Looking in the <b>Application</b> section under <b>Windows Logs</b> we find the following message:</p>
<p style="margin: 20px; color: #800000;" color="#800000"><i>Windows API call SHGetKnownFolderPath returned error code: 5. Windows system error message is: Access is denied.<br /> Reported at line: 400.</i></p>
<p>Followed by this one:</p>
<p style="margin: 20px; color: #800000;" color="#800000"><i>Cannot get a local application data path. Most probably a user profile is not loaded. If LocalDB is executed under IIS, make sure that profile loading is enabled for the current user.</i></p>
<p>Most likely there will be several copies of these two errors, as ADO.NET connection logic attempts to connect multiple times at different intervals:</p>
<p><a href="https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/37/92/2011_2D00_12_2D00_08/4135.0_1.EventLog.png" original-url="http://blogs.msdn.com/cfs-filesystemfile.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-00-37-92-2011_2D00_12_2D00_08/4135.0_5F00_1.EventLog.png"><img style="max-width: 550px;" border="0" alt="" src="https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/37/92/2011_2D00_12_2D00_08/4135.0_1.EventLog.png" original-url="http://blogs.msdn.com/cfs-filesystemfile.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-00-37-92-2011_2D00_12_2D00_08/4135.0_5F00_1.EventLog.png" /></a></p>
<p>The second message is clear, the problem we're facing is that the user profile needs to be loaded. That shouldn't be hard since each IIS Application Pool has an option called <b>Load User Profile</b> that can be found in <b>Advanced Settings</b> section. Unfortunately things got slightly more complicated in Service Pack 1 for Windows 7. As described in <a href="http://support.microsoft.com/kb/2547655">KB 2547655</a> enabling <b>loadUserProfile</b> is not enough to fully load user profile, we also need to enable <b>setProfileEnvironment</b>. This requires editing <b>applicationHost.config</b> file which is usually located in C:\Windows\System32\inetsrv\config. Following the instructions from <a href="http://support.microsoft.com/kb/2547655">KB 2547655</a> we should enable both flags for Application Pool <b>ASP.NET v4.0</b>, like this:</p>
<p style="margin: 20px;"><span style="font-family: Consolas; color: #0000ff;" face="Consolas" color="#0000ff"> <span style="color: #0000ff;" color="#0000ff">&lt;</span><span style="color: #800000;" color="#800000">add</span> <span style="color: #ff0000;" color="#ff0000">name</span>=<span style="color: #000000;" color="#000000">"</span><span style="color: #0000ff;" color="#0000ff">ASP.NET v4.0</span><span style="color: #000000;" color="#000000">"</span> <span style="color: #ff0000;" color="#ff0000">autoStart</span>=<span style="color: #000000;" color="#000000">"</span><span style="color: #0000ff;" color="#0000ff">true</span><span style="color: #000000;" color="#000000">"</span> <span style="color: #ff0000;" color="#ff0000">managedRuntimeVersion</span>=<span style="color: #000000;" color="#000000">"</span><span style="color: #0000ff;" color="#0000ff">v4.0</span><span style="color: #000000;" color="#000000">"</span> <span style="color: #ff0000;" color="#ff0000">managedPipelineMode</span>=<span style="color: #000000;" color="#000000">"</span><span style="color: #0000ff;" color="#0000ff">Integrated</span><span style="color: #000000;" color="#000000">"</span><span style="color: #0000ff;" color="#0000ff">&gt;</span><br /> <span style="margin-left: 40px;"><span style="color: #0000ff;" color="#0000ff">&lt;</span><span style="color: #800000;" color="#800000">processModel</span> <span style="color: #ff0000;" color="#ff0000">identityType</span>=<span style="color: #000000;" color="#000000">"</span><span style="color: #0000ff;" color="#0000ff">ApplicationPoolIdentity</span><span style="color: #000000;" color="#000000">"</span> <b><span style="color: #ff0000;" color="#ff0000">loadUserProfile</span>=<span style="color: #000000;" color="#000000">"</span><span style="color: #0000ff;" color="#0000ff">true</span><span style="color: #000000;" color="#000000">"</span> <span style="color: #ff0000;" color="#ff0000">setProfileEnvironment</span>=<span style="color: #000000;" color="#000000">"</span><span style="color: #0000ff;" color="#0000ff">true</span><span style="color: #000000;" color="#000000">"</span></b> <span style="color: #0000ff;" color="#0000ff">/&gt;</span></span><br /> <span style="color: #0000ff;" color="#0000ff">&lt;/</span><span style="color: #800000;" color="#800000">add</span><span style="color: #0000ff;" color="#0000ff">&gt;</span> </span></p>
<p>Having completed that we restart the Application Pool to make sure the new settings are applied and run our Web Application again. If everything went as expected we should be ... faced by a new error:</p>
<p><a href="https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/37/92/2011_2D00_12_2D00_08/4278.1.0_AspNetFailure2.png" original-url="http://blogs.msdn.com/cfs-filesystemfile.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-00-37-92-2011_2D00_12_2D00_08/4278.1.0_5F00_AspNetFailure2.png"><img style="max-width: 550px;" border="0" alt="" src="https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/37/92/2011_2D00_12_2D00_08/4278.1.0_AspNetFailure2.png" original-url="http://blogs.msdn.com/cfs-filesystemfile.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-00-37-92-2011_2D00_12_2D00_08/4278.1.0_5F00_AspNetFailure2.png" /></a></p>
<p>There's no reason to panic, as this error is fully expected. After all we haven't dealt with the second problem with running LocalDB under full IIS. We still need to address the fact that by default LocalDB instances are private, which means that IIS, running as ApplicationPoolIdentity, will not have access to our LocalDB instance, running as our Windows account. We will explore different ways to address this problem in the <a href="http://blogs.msdn.com/b/sqlexpress/archive/2011/12/09/using-localdb-with-full-iis-part-2-instance-ownership.aspx">second post</a> from this mini-series on using LocalDB under full IIS.</p>
<p>- Krzysztof Kozielczyk</p>
<h3>Share Your Feedback</h3>
<p>Please share your feedback with us! Just start a thread on <a href="http://social.msdn.microsoft.com/Forums/sqlexpress/">SQL Express Forum</a>, hit the "Email Author" button on this post, or file a <a href="http://connect.microsoft.com/SQLServer">Connect</a> item!</p>
	</div><!-- .entry-content -->


	<footer class="entry-footer single">
				<hr>
	</footer><!-- .entry-footer -->

</article><!-- #post-## -->

			
		</div><!-- #single-content -->

		
<div id="comments" class="comments-area">
	<div class="comments-title">
		Comments (26)	</div>

	
			<div class="navigation pagination clear-both">
					</div>

		<ol class="comment-list">
					<li class="comment byuser comment-author-patricklambinyahoo-com even thread-even depth-1" id="comment-732">
				<div id="div-comment-732" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='https://i1.social.s-msft.com/profile/u/avatar.jpg?displayname=Papy+Normand&size=extralarge&version=97f01295-b571-4730-a052-b01219e18a4f'  class='avatar avatar-56 photo' height='56' width='56' />			<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Papy+Normand' rel='external nofollow' class='url'>Papy Normand</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/sqlexpress/2011/12/08/using-localdb-with-full-iis-part-1-user-profile/#comment-732">
			March 30, 2012 at 7:41 am</a>		</div>

		<p>I have used IIS so rarely that i am sure i will write an enormeous error : when you are writing &quot;full IIS&quot;, do you mean that it is not working with IS 7.5 ?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-wardbeattiehotmail-com odd alt thread-odd thread-alt depth-1" id="comment-733">
				<div id="div-comment-733" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='https://i1.social.s-msft.com/profile/u/avatar.jpg?displayname=Ward+Beattie+%5BMSFT%5D&size=extralarge&version=00000000-0000-0000-0000-000000000000'  class='avatar avatar-56 photo' height='56' width='56' />			<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Ward+Beattie+%5BMSFT%5D' rel='external nofollow' class='url'>Ward Beattie [MSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/sqlexpress/2011/12/08/using-localdb-with-full-iis-part-1-user-profile/#comment-733">
			March 30, 2012 at 11:00 am</a>		</div>

		<p>Thanks for your question. By &quot;Full IIS&quot;, Krzysztof is referring to the IIS production-capable feature of Windows Server. For Windows 7 and Windows Server 2008 R2, this is IIS 7.5. We call it &quot;Full IIS&quot; to distinguish it from IIS Express, which is a light-weight developer version of IIS that runs in the user&#39;s security context.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-patricklambinyahoo-com even thread-even depth-1" id="comment-735">
				<div id="div-comment-735" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='https://i1.social.s-msft.com/profile/u/avatar.jpg?displayname=Papy+Normand&size=extralarge&version=97f01295-b571-4730-a052-b01219e18a4f'  class='avatar avatar-56 photo' height='56' width='56' />			<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Papy+Normand' rel='external nofollow' class='url'>Papy Normand</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/sqlexpress/2011/12/08/using-localdb-with-full-iis-part-1-user-profile/#comment-735">
			April 2, 2012 at 2:33 am</a>		</div>

		<p>Hello Ward Beattie,</p>
<p>I am sorry for my late reply : i have nothing to reply except many thanks&#8230;.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-757">
				<div id="div-comment-757" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='https://secure.gravatar.com/avatar/3651e719491c63d4424134d66fe53db9?s=56&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/3651e719491c63d4424134d66fe53db9?s=112&#038;d=mm&#038;r=g 2x' class='avatar avatar-56 photo' height='56' width='56' />			<cite class="fn">Sergio</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/sqlexpress/2011/12/08/using-localdb-with-full-iis-part-1-user-profile/#comment-757">
			June 12, 2012 at 5:29 am</a>		</div>

		<p>Am I correct in assuming that this means that LocalDB cannot be started as a service running under the LocalSystem account?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-wardbeattiehotmail-com even thread-even depth-1" id="comment-759">
				<div id="div-comment-759" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='https://i1.social.s-msft.com/profile/u/avatar.jpg?displayname=Ward+Beattie+%5BMSFT%5D&size=extralarge&version=00000000-0000-0000-0000-000000000000'  class='avatar avatar-56 photo' height='56' width='56' />			<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Ward+Beattie+%5BMSFT%5D' rel='external nofollow' class='url'>Ward Beattie [MSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/sqlexpress/2011/12/08/using-localdb-with-full-iis-part-1-user-profile/#comment-759">
			June 12, 2012 at 5:40 am</a>		</div>

		<p>LocalDB does not run as a service itself. It runs as a background process in the context of the user that starts it. That said, you could write an application that itself runs as a service and uses LocalDB &#8230;.</p>
<p>Ward.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-760">
				<div id="div-comment-760" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='https://secure.gravatar.com/avatar/3651e719491c63d4424134d66fe53db9?s=56&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/3651e719491c63d4424134d66fe53db9?s=112&#038;d=mm&#038;r=g 2x' class='avatar avatar-56 photo' height='56' width='56' />			<cite class="fn">Sergio</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/sqlexpress/2011/12/08/using-localdb-with-full-iis-part-1-user-profile/#comment-760">
			June 12, 2012 at 5:52 am</a>		</div>

		<p>I have the following scenario:</p>
<p>A WCF Service Application runing as service under the LocalSystem account, and accessing a &quot;Customers&quot; database. </p>
<p>At the same time I have other applications running under the current user access the &quot;Customers&quot; database, some through the WCF service, and some access the database directly.</p>
<p>Would LocalDB handle this type of scenario?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-wardbeattiehotmail-com even thread-even depth-1" id="comment-761">
				<div id="div-comment-761" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='https://i1.social.s-msft.com/profile/u/avatar.jpg?displayname=Ward+Beattie+%5BMSFT%5D&size=extralarge&version=00000000-0000-0000-0000-000000000000'  class='avatar avatar-56 photo' height='56' width='56' />			<cite class="fn"><a href='https://social.msdn.microsoft.com/profile/Ward+Beattie+%5BMSFT%5D' rel='external nofollow' class='url'>Ward Beattie [MSFT]</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/sqlexpress/2011/12/08/using-localdb-with-full-iis-part-1-user-profile/#comment-761">
			June 12, 2012 at 6:29 am</a>		</div>

		<p>Hi Sergio,</p>
<p>You can use LocalDB in this scenario (although running any application as LocalSystem is discouraged &#8230; but this is another subject).</p>
<p>In this design, your WCF service is responsible for keeping its LocalDB instance running. It can do this by maintaining a connection, or by configuring LocalDB (sp_configure) to run forever.</p>
<p>To allow a local user to access the database directly, you can use LocalDB&#39;s &quot;shared instance&quot; feature (see <a rel="nofollow" target="_new" href="http://blogs.msdn.com/b/sqlexpress/archive/2011/12/09/using-localdb-with-full-iis-part-2-instance-ownership.aspx">blogs.msdn.com/&#8230;/using-localdb-with-full-iis-part-2-instance-ownership.aspx</a>).</p>
<p>Note that LocalDB does not support remote users for direct access to the database. You can, of course, support remote users via your WCF application service.</p>
<p>Ward.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-764">
				<div id="div-comment-764" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='https://secure.gravatar.com/avatar/3651e719491c63d4424134d66fe53db9?s=56&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/3651e719491c63d4424134d66fe53db9?s=112&#038;d=mm&#038;r=g 2x' class='avatar avatar-56 photo' height='56' width='56' />			<cite class="fn">Josh</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/sqlexpress/2011/12/08/using-localdb-with-full-iis-part-1-user-profile/#comment-764">
			June 20, 2012 at 11:15 pm</a>		</div>

		<p>If you&#39;re looking to script this..</p>
<p>appcmd set apppool &quot;AppPoolName&quot; /autoStart:true /processModel.loadUserProfile:true /processModel.setProfileEnvironment:true</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-799">
				<div id="div-comment-799" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='https://secure.gravatar.com/avatar/3651e719491c63d4424134d66fe53db9?s=56&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/3651e719491c63d4424134d66fe53db9?s=112&#038;d=mm&#038;r=g 2x' class='avatar avatar-56 photo' height='56' width='56' />			<cite class="fn">Matthew Steeples</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/sqlexpress/2011/12/08/using-localdb-with-full-iis-part-1-user-profile/#comment-799">
			October 19, 2012 at 1:55 am</a>		</div>

		<p>Just want to say thanks to Josh there for including this as a script.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-816">
				<div id="div-comment-816" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='https://secure.gravatar.com/avatar/3651e719491c63d4424134d66fe53db9?s=56&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/3651e719491c63d4424134d66fe53db9?s=112&#038;d=mm&#038;r=g 2x' class='avatar avatar-56 photo' height='56' width='56' />			<cite class="fn">Nate</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/sqlexpress/2011/12/08/using-localdb-with-full-iis-part-1-user-profile/#comment-816">
			February 21, 2013 at 8:38 am</a>		</div>

		<p>Any idea what I should do next if after making the specified changes to the applicationHost.config file, my error message is:</p>
<p>A network-related or instance-specific error occurred while establishing a connection to SQL Server. The server was not found or was not accessible. Verify that the instance name is correct and that SQL Server is configured to allow remote connections. (provider: SQL Network Interfaces, error: 50 &#8211; Local Database Runtime error occurred. Error occurred during LocalDB instance startup: SQL Server process failed to start.)</p>
<p>Instead of the &#39;Cannot open database&#39; bit that you told me to expect?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-818">
				<div id="div-comment-818" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='https://secure.gravatar.com/avatar/3651e719491c63d4424134d66fe53db9?s=56&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/3651e719491c63d4424134d66fe53db9?s=112&#038;d=mm&#038;r=g 2x' class='avatar avatar-56 photo' height='56' width='56' />			<cite class="fn">Valentin</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/sqlexpress/2011/12/08/using-localdb-with-full-iis-part-1-user-profile/#comment-818">
			February 27, 2013 at 3:17 am</a>		</div>

		<p>I&#39;ve got the same problem as Nate here. After making the changes, the error is still the same. Any idea?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-826">
				<div id="div-comment-826" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='https://secure.gravatar.com/avatar/3651e719491c63d4424134d66fe53db9?s=56&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/3651e719491c63d4424134d66fe53db9?s=112&#038;d=mm&#038;r=g 2x' class='avatar avatar-56 photo' height='56' width='56' />			<cite class="fn">Jack Bond</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/sqlexpress/2011/12/08/using-localdb-with-full-iis-part-1-user-profile/#comment-826">
			June 15, 2013 at 10:57 am</a>		</div>

		<p>So the entire point of LocalDb was to make it EASY for developers and yet issues like this come up. I&#39;m having a similar problem trying to use LocalDb in an Azure role. Here&#39;s EASY&#8230;</p>
<p>1) Give logical connection string</p>
<p>2) Call Open</p>
<p>3) It works</p>
<p>Forget all the sharing nonsense, automatic instances, and security. They should provide a mode where it just works. MASSIVE FAIL.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-827">
				<div id="div-comment-827" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='https://secure.gravatar.com/avatar/1b284fbaff660e5e37a1cc95ce7bbd53?s=56&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/1b284fbaff660e5e37a1cc95ce7bbd53?s=112&#038;d=mm&#038;r=g 2x' class='avatar avatar-56 photo' height='56' width='56' />			<cite class="fn">cestes001@msn.com</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/sqlexpress/2011/12/08/using-localdb-with-full-iis-part-1-user-profile/#comment-827">
			June 20, 2013 at 12:06 pm</a>		</div>

		<p>If anyone is still listening at MSFT, this DOES NOT work for Windows Server 8 SP2 with IIS 7. &nbsp;The attribute setProfileEnvironment is &quot;unrecognized&quot;. &nbsp;</p>
<p>What gives?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-835">
				<div id="div-comment-835" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='https://secure.gravatar.com/avatar/3651e719491c63d4424134d66fe53db9?s=56&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/3651e719491c63d4424134d66fe53db9?s=112&#038;d=mm&#038;r=g 2x' class='avatar avatar-56 photo' height='56' width='56' />			<cite class="fn">taylor</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/sqlexpress/2011/12/08/using-localdb-with-full-iis-part-1-user-profile/#comment-835">
			October 8, 2013 at 11:57 am</a>		</div>

		<p>I also wasn&#39;t able to get past the first error with these steps. the solution was to follow these steps included in 3-13. Setting Up a Shared Instance of LocalDB, in the ebook link below.</p>
<p>In summary the steps were</p>
<p>1. Create a shared LocalDB Instance.</p>
<p>2. Modify connection string in your web.config.</p>
<p>3. create a login for IIS in the localDB instance.</p>
<p><a rel="nofollow" target="_new" href="http://books.google.com/books?id=ZnHGAER4j-oC&amp;lpg=PA102&amp;ots=Cg_ZqQjAsp&amp;dq=problem%20with%20localdb%20and%20IIS&amp;pg=PA102#v=onepage&amp;q=problem%20with%20localdb%20and%20IIS&amp;f=false">books.google.com/books</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-853">
				<div id="div-comment-853" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='https://secure.gravatar.com/avatar/3651e719491c63d4424134d66fe53db9?s=56&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/3651e719491c63d4424134d66fe53db9?s=112&#038;d=mm&#038;r=g 2x' class='avatar avatar-56 photo' height='56' width='56' />			<cite class="fn">Michael Dereje</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/sqlexpress/2011/12/08/using-localdb-with-full-iis-part-1-user-profile/#comment-853">
			December 3, 2013 at 9:34 am</a>		</div>

		<p>Hey Krzysztof,</p>
<p>This was a good informative post thank you! However it worked on my lap top which is windows 7, 32 bit but when i try the solution on a windows 64 desktop that uses windows 7 professional sp1. The error will not go away. Any ideas to why that is?</p>
<p>Thanks,</p>
<p>Michael </p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-854">
				<div id="div-comment-854" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='https://secure.gravatar.com/avatar/3651e719491c63d4424134d66fe53db9?s=56&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/3651e719491c63d4424134d66fe53db9?s=112&#038;d=mm&#038;r=g 2x' class='avatar avatar-56 photo' height='56' width='56' />			<cite class="fn">Rafael</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/sqlexpress/2011/12/08/using-localdb-with-full-iis-part-1-user-profile/#comment-854">
			December 6, 2013 at 10:18 am</a>		</div>

		<p>Ive enabled the &quot;loadUserProfile&quot; and enabled &quot;setProfileEnvironment.&quot; but the application still not working.</p>
<p>Always the same error:</p>
<p>&quot;A network-related or instance-specific error occurred while establishing a connection to SQL Server. The server was not found or was not accessible. Verify that the instance name is correct and that SQL Server is configured to allow remote connections. (provider: SQL Network Interfaces, error: 50 &#8211; Local Database Runtime error occurred. Cannot create an automatic instance. See the Windows Application event log for error details.&quot;</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-859">
				<div id="div-comment-859" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='https://secure.gravatar.com/avatar/3651e719491c63d4424134d66fe53db9?s=56&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/3651e719491c63d4424134d66fe53db9?s=112&#038;d=mm&#038;r=g 2x' class='avatar avatar-56 photo' height='56' width='56' />			<cite class="fn">Lyne</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/sqlexpress/2011/12/08/using-localdb-with-full-iis-part-1-user-profile/#comment-859">
			January 26, 2014 at 7:25 pm</a>		</div>

		<p>Any news on that issue ?? I have the same stoopid error as you, despite doing what is suggested above. &nbsp;This only works if I start a new MVC project. As soon as I try to create another database and connect on it, it won&#39;t work. &nbsp;I cannot even try to connect the project on a simple SQL SERVER instance. -_- &nbsp;Easy they said &#8230; </p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-861">
				<div id="div-comment-861" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='https://secure.gravatar.com/avatar/3651e719491c63d4424134d66fe53db9?s=56&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/3651e719491c63d4424134d66fe53db9?s=112&#038;d=mm&#038;r=g 2x' class='avatar avatar-56 photo' height='56' width='56' />			<cite class="fn">themien</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/sqlexpress/2011/12/08/using-localdb-with-full-iis-part-1-user-profile/#comment-861">
			February 10, 2014 at 6:10 am</a>		</div>

		<p>doing this worked for me, i didn&#39; even have to follow the 2nd part</p>
<p><a rel="nofollow" target="_new" href="http://www.aspneter.com/2013/08/error-50-local-database-runtime-error-occurred/">http://www.aspneter.com/&#8230;/error-50-local-database-runtime-error-occurred</a></p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-876">
				<div id="div-comment-876" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='https://secure.gravatar.com/avatar/3651e719491c63d4424134d66fe53db9?s=56&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/3651e719491c63d4424134d66fe53db9?s=112&#038;d=mm&#038;r=g 2x' class='avatar avatar-56 photo' height='56' width='56' />			<cite class="fn">Andrej</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/sqlexpress/2011/12/08/using-localdb-with-full-iis-part-1-user-profile/#comment-876">
			April 13, 2014 at 4:00 pm</a>		</div>

		<p>Perfect, works like a charm! (MVC 5, EF 6.1, Web API 2.0)</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-889">
				<div id="div-comment-889" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='https://secure.gravatar.com/avatar/3651e719491c63d4424134d66fe53db9?s=56&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/3651e719491c63d4424134d66fe53db9?s=112&#038;d=mm&#038;r=g 2x' class='avatar avatar-56 photo' height='56' width='56' />			<cite class="fn">Luke Ballantine</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/sqlexpress/2011/12/08/using-localdb-with-full-iis-part-1-user-profile/#comment-889">
			June 23, 2014 at 3:49 pm</a>		</div>

		<p>Excellent article &#8211; and the follow up! Saved me some head scratching.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-896">
				<div id="div-comment-896" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='https://secure.gravatar.com/avatar/3651e719491c63d4424134d66fe53db9?s=56&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/3651e719491c63d4424134d66fe53db9?s=112&#038;d=mm&#038;r=g 2x' class='avatar avatar-56 photo' height='56' width='56' />			<cite class="fn">Helobis Lukasz Jaskiewicz</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/sqlexpress/2011/12/08/using-localdb-with-full-iis-part-1-user-profile/#comment-896">
			July 22, 2014 at 4:25 pm</a>		</div>

		<p>The trick is to use the code first approach and let Entity Framework create a new database on the first run on the production server where the full version of IIS is running.</p>
<p>If you deploy your web application including an already created LocalDB from your development server, the LocalDB will still have the logon and user settings from your development server and therefore the described exceptions will come up.</p>
<p>There is no need to change the user identity of the AppPool.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1041">
				<div id="div-comment-1041" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='https://secure.gravatar.com/avatar/3651e719491c63d4424134d66fe53db9?s=56&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/3651e719491c63d4424134d66fe53db9?s=112&#038;d=mm&#038;r=g 2x' class='avatar avatar-56 photo' height='56' width='56' />			<cite class="fn">Mikhail</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/sqlexpress/2011/12/08/using-localdb-with-full-iis-part-1-user-profile/#comment-1041">
			June 17, 2015 at 7:56 am</a>		</div>

		<p>I spent about 12 hours, before find this post. Thank you very much/</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1031">
				<div id="div-comment-1031" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='https://secure.gravatar.com/avatar/3651e719491c63d4424134d66fe53db9?s=56&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/3651e719491c63d4424134d66fe53db9?s=112&#038;d=mm&#038;r=g 2x' class='avatar avatar-56 photo' height='56' width='56' />			<cite class="fn">Josef</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/sqlexpress/2011/12/08/using-localdb-with-full-iis-part-1-user-profile/#comment-1031">
			June 27, 2015 at 3:13 pm</a>		</div>

		<p>I believe I have found a reason why the loadUserProfile and setProfileEnvironment does not work on some systems.</p>
<p>I did some digging, and found that the problem lies with the C:WindowsSystem32inetsrvconfig directory. It seems that Windows keeps two versions of this directory. One for 64bit processes, and the other for 32bit.</p>
<p>That means if you tried to edit the applicationHost.config file using a third party text editor, which happens to be 32bit, the 64bit IIS will never see the changes that you made. Try making the edits using regular Notepad.</p>
<p>I also found that I had to fully restart the computer, not just Service / IIS / App Pool, for the changes to manifest.</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1021">
				<div id="div-comment-1021" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='https://secure.gravatar.com/avatar/3651e719491c63d4424134d66fe53db9?s=56&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/3651e719491c63d4424134d66fe53db9?s=112&#038;d=mm&#038;r=g 2x' class='avatar avatar-56 photo' height='56' width='56' />			<cite class="fn">Kinzo</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/sqlexpress/2011/12/08/using-localdb-with-full-iis-part-1-user-profile/#comment-1021">
			June 29, 2015 at 11:38 pm</a>		</div>

		<p>This worked for me and I&#39;m an experienced developer. Thanks mate</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1011">
				<div id="div-comment-1011" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='https://secure.gravatar.com/avatar/3651e719491c63d4424134d66fe53db9?s=56&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/3651e719491c63d4424134d66fe53db9?s=112&#038;d=mm&#038;r=g 2x' class='avatar avatar-56 photo' height='56' width='56' />			<cite class="fn">Shivdeep</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/sqlexpress/2011/12/08/using-localdb-with-full-iis-part-1-user-profile/#comment-1011">
			July 29, 2015 at 8:52 am</a>		</div>

		<p>I kept getting the error even after changing the settings on for &quot;loadUserProfile&quot; and &quot;setProfileEnvironment.&quot; </p>
<p>&quot;A network-related or instance-specific error occurred while establishing a connection to SQL Server. The server was not found or was not accessible. Verify that the instance name is correct and that SQL Server is configured to allow remote connections. (provider: SQL Network Interfaces, error: 50 &#8211; Local Database Runtime error occurred. Cannot create an automatic instance. See the Windows Application event log for error details.&quot;</p>
<p>I had to follow the second part (<a rel="nofollow" target="_new" href="http://www.aspneter.com/2013/08/error-50-local-database-runtime-error-occurred/">http://www.aspneter.com/&#8230;/error-50-local-database-runtime-error-occurred</a>) to get it working!</p>
<p>Not sure why changing &#8211; &nbsp;identityType=&quot;NetworkService&quot; works for some and is not needed for others, any thoughts? Will there be issues with changing this?</p>

		
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1231">
				<div id="div-comment-1231" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='https://secure.gravatar.com/avatar/3651e719491c63d4424134d66fe53db9?s=56&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/3651e719491c63d4424134d66fe53db9?s=112&#038;d=mm&#038;r=g 2x' class='avatar avatar-56 photo' height='56' width='56' />			<cite class="fn">vishal</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://blogs.msdn.microsoft.com/sqlexpress/2011/12/08/using-localdb-with-full-iis-part-1-user-profile/#comment-1231">
			November 23, 2015 at 1:32 am</a>		</div>

		<p>hey thank you for posting this..</p>
<p>but i need your help .</p>
<p>When i m try to find configuration folder at system32/inetsrv this path, I count find it.</p>
<p>please reply me as fast as possible way to solve this problem</p>

		
				</div>
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

		<div class="navigation pagination">
					</div>

	
			<p class="no-comments">Comments are closed.</p>
	
</div><!-- .comments-area -->
	</div><!-- #primary -->
	<a class="screen-reader-shortcut" href="#primary" tabindex="1">Skip to main content</a>

<div id="secondary" class="sidebar col-sm-3">
	<div id="sidebar-widget-area" class="sidebar-widget-area" role="complementary">
		<aside id="sfmsb_settings-3" class="widget sfmsb_widget"><div class="sfmsb-follow-social-buttons sfmsb-under sfmsb-circle 40 sfmsb-horizontal"><h2 class="widget-title">Follow Us</h2><a title="RSS Feed" aria-label="RSS Feed" target="_blank" href="https://blogs.msdn.microsoft.com/sqlexpress/feed/"><span class="sfmsb-icon-feed sfmsb-circle" style="color:#ffa500;font-size:40px;" data-color="#ffa500"></span></a><div class="sfmsb-clearfix"></div></div></aside><aside id="tag_cloud-3" class="widget widget_tag_cloud"><h2 class="widget-title">Popular Tags</h2><div class="tagcloud"><a href="https://blogs.msdn.microsoft.com/sqlexpress/tag/product-info/" class="tag-cloud-link tag-link-3 tag-link-position-1" style="font-size: 14px;">Product Info</a>
<a href="https://blogs.msdn.microsoft.com/sqlexpress/tag/headlines/" class="tag-cloud-link tag-link-8 tag-link-position-2" style="font-size: 14px;">Headlines</a>
<a href="https://blogs.msdn.microsoft.com/sqlexpress/tag/faq/" class="tag-cloud-link tag-link-4 tag-link-position-3" style="font-size: 14px;">FAQ</a>
<a href="https://blogs.msdn.microsoft.com/sqlexpress/tag/general/" class="tag-cloud-link tag-link-2 tag-link-position-4" style="font-size: 14px;">General</a>
<a href="https://blogs.msdn.microsoft.com/sqlexpress/tag/archive/" class="tag-cloud-link tag-link-5 tag-link-position-5" style="font-size: 14px;">Archive</a>
<a href="https://blogs.msdn.microsoft.com/sqlexpress/tag/samples/" class="tag-cloud-link tag-link-6 tag-link-position-6" style="font-size: 14px;">Samples</a>
<a href="https://blogs.msdn.microsoft.com/sqlexpress/tag/futures/" class="tag-cloud-link tag-link-7 tag-link-position-7" style="font-size: 14px;">Futures</a>
<a href="https://blogs.msdn.microsoft.com/sqlexpress/tag/pages/" class="tag-cloud-link tag-link-9 tag-link-position-8" style="font-size: 14px;">Pages</a>
<a href="https://blogs.msdn.microsoft.com/sqlexpress/tag/installation/" class="tag-cloud-link tag-link-10 tag-link-position-9" style="font-size: 14px;">Installation</a>
<a href="https://blogs.msdn.microsoft.com/sqlexpress/tag/localdb/" class="tag-cloud-link tag-link-11 tag-link-position-10" style="font-size: 14px;">localdb</a></div>
</aside><aside id="msdn-archive-widget-3" class="widget msdn-archive-widget"><h2 class="widget-title">Archives</h2>	<li><a href='https://blogs.msdn.microsoft.com/sqlexpress/2012/03/'>March 2012</a>&nbsp;(1)</li>
	<li><a href='https://blogs.msdn.microsoft.com/sqlexpress/2011/12/'>December 2011</a>&nbsp;(2)</li>
	<li><a href='https://blogs.msdn.microsoft.com/sqlexpress/2011/11/'>November 2011</a>&nbsp;(2)</li>
	<li><a href='https://blogs.msdn.microsoft.com/sqlexpress/2011/10/'>October 2011</a>&nbsp;(2)</li>
	<li><a href='https://blogs.msdn.microsoft.com/sqlexpress/2011/07/'>July 2011</a>&nbsp;(1)</li>
	<li><a href='https://blogs.msdn.microsoft.com/sqlexpress/2011/03/'>March 2011</a>&nbsp;(1)</li>
	<li><a href='https://blogs.msdn.microsoft.com/sqlexpress/2010/04/'>April 2010</a>&nbsp;(2)</li>
	<li><a href='https://blogs.msdn.microsoft.com/sqlexpress/2010/02/'>February 2010</a>&nbsp;(2)</li>
	<li><a href='https://blogs.msdn.microsoft.com/sqlexpress/2009/12/'>December 2009</a>&nbsp;(1)</li>
	<li><a href='https://blogs.msdn.microsoft.com/sqlexpress/2009/11/'>November 2009</a>&nbsp;(1)</li>
	<li><a href='https://blogs.msdn.microsoft.com/sqlexpress/2009/09/'>September 2009</a>&nbsp;(3)</li>
	<li><a href='https://blogs.msdn.microsoft.com/sqlexpress/2012/'>All of 2012</a>&nbsp;(1)</li>
	<li><a href='https://blogs.msdn.microsoft.com/sqlexpress/2011/'>All of 2011</a>&nbsp;(8)</li>
	<li><a href='https://blogs.msdn.microsoft.com/sqlexpress/2010/'>All of 2010</a>&nbsp;(4)</li>
	<li><a href='https://blogs.msdn.microsoft.com/sqlexpress/2009/'>All of 2009</a>&nbsp;(18)</li>
	<li><a href='https://blogs.msdn.microsoft.com/sqlexpress/2008/'>All of 2008</a>&nbsp;(15)</li>
	<li><a href='https://blogs.msdn.microsoft.com/sqlexpress/2007/'>All of 2007</a>&nbsp;(10)</li>
	<li><a href='https://blogs.msdn.microsoft.com/sqlexpress/2006/'>All of 2006</a>&nbsp;(38)</li>
	<li><a href='https://blogs.msdn.microsoft.com/sqlexpress/2005/'>All of 2005</a>&nbsp;(10)</li>
	<li><a href='https://blogs.msdn.microsoft.com/sqlexpress/2004/'>All of 2004</a>&nbsp;(22)</li>
</aside>	</div>
</div><!-- #secondary -->
</div><!-- .site-content -->

<footer id="site-footer" class="site-footer row" role="contentinfo">
	<div id="site-info" class="site-info">
		<div id="footer-text" class="col-sm-4 col-sm-offset-6">
			<span>
				<a href="https://privacy.microsoft.com" data-mscc-ic="false">Privacy</a>
			</span>
			<span>
				<a href="https://msdn.microsoft.com/cc300389" data-mscc-ic="false">Terms of Use</a>
			</span>
			<span>
				<a href="https://www.microsoft.com/en-us/legal/intellectualproperty/Trademarks/EN-US.aspx" data-mscc-ic="false">Trademarks</a>
			</span>
		</div>
		<div id="footer-far" class="col-sm-2">
			<div id="footer-microsoft-logo">
				<a href="https://www.microsoft.com" aria-label="Microsoft Logo">
					<svg id="footer-microsoft-logo-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 347 70.5" enable-background="new 0 0 347 70.5"><g fill="#fff"><path d="M39.5 44.6l-2.8 7.9h-.2c-.5-1.8-1.3-4.5-2.7-7.8l-15-37.7h-14.7v60h9.7v-37c0-2.3 0-5-.1-8.2-.1-1.6-.2-2.9-.3-3.8h.2c.5 2.3 1 4 1.4 5.1l18 43.8h6.8l17.9-44.2c.4-1 .8-3 1.2-4.7h.2c-.2 4.4-.4 8.4-.5 10.8v38.1h10.4v-60h-14.1l-15.4 37.7zM78.8 23.9h10.1v43h-10.1zM83.9 5.7c-1.7 0-3.1.6-4.3 1.7-1.2 1.1-1.8 2.5-1.8 4.2 0 1.6.6 3 1.8 4.1 1.2 1.1 2.6 1.6 4.3 1.6 1.7 0 3.2-.6 4.3-1.6 1.2-1.1 1.8-2.5 1.8-4.1 0-1.6-.6-3-1.8-4.2-1-1.2-2.5-1.7-4.3-1.7M124.7 23.5c-1.9-.4-3.8-.6-5.7-.6-4.6 0-8.8 1-12.3 3s-6.3 4.8-8.1 8.3c-1.9 3.6-2.8 7.7-2.8 12.4 0 4.1.9 7.8 2.7 11.1 1.8 3.3 4.3 5.9 7.6 7.7 3.2 1.8 6.9 2.7 11.1 2.7 4.8 0 8.9-1 12.2-2.9l.1-.1v-9.3l-.4.3c-1.5 1.1-3.2 2-4.9 2.6-1.8.6-3.4.9-4.8.9-4 0-7.2-1.2-9.5-3.7s-3.5-5.9-3.5-10.2c0-4.4 1.2-7.9 3.6-10.5 2.4-2.6 5.6-3.9 9.5-3.9 3.3 0 6.6 1.1 9.6 3.3l.4.3v-9.8l-.1-.1c-1.2-.6-2.8-1.1-4.7-1.5M158 23.2c-2.5 0-4.8.8-6.8 2.4-1.7 1.4-2.9 3.4-3.9 5.8h-.1v-7.4h-10.1v43h10.1v-22c0-3.7.8-6.8 2.5-9.1s3.9-3.5 6.5-3.5c.9 0 1.9.2 3 .4 1.1.3 1.9.6 2.4 1l.4.3v-10.2l-.2-.1c-.8-.4-2.1-.6-3.8-.6M185.5 22.9c-7.1 0-12.7 2.1-16.7 6.2s-6 9.8-6 16.9c0 6.7 2 12.1 5.9 16.1 3.9 3.9 9.2 5.9 15.8 5.9 6.9 0 12.4-2.1 16.4-6.3 4-4.2 6-9.8 6-16.7 0-6.8-1.9-12.3-5.7-16.2-3.7-3.9-9-5.9-15.7-5.9m8 33.1c-1.9 2.4-4.8 3.6-8.5 3.6s-6.6-1.2-8.7-3.7c-2.1-2.4-3.1-5.9-3.1-10.3 0-4.6 1.1-8.1 3.1-10.6 2.1-2.5 5-3.7 8.6-3.7 3.6 0 6.4 1.2 8.4 3.6 2 2.4 3.1 5.9 3.1 10.5s-1 8.2-2.9 10.6M229.3 41.7c-3.2-1.3-5.2-2.3-6.1-3.2-.8-.8-1.2-1.9-1.2-3.3 0-1.2.5-2.3 1.6-3.1 1.1-.8 2.5-1.2 4.4-1.2 1.7 0 3.5.3 5.2.8 1.7.5 3.3 1.2 4.5 2.1l.4.3v-9.4l-.2-.1c-1.2-.5-2.7-.9-4.6-1.3-1.9-.3-3.6-.5-5-.5-4.8 0-8.8 1.2-11.9 3.7-3.1 2.4-4.6 5.7-4.6 9.5 0 2 .3 3.8 1 5.3s1.7 2.9 3.1 4c1.4 1.1 3.4 2.3 6.2 3.5 2.3 1 4.1 1.8 5.2 2.4 1.1.6 1.8 1.3 2.3 1.9.4.6.6 1.4.6 2.4 0 2.9-2.2 4.3-6.6 4.3-1.7 0-3.5-.3-5.6-1-2.1-.7-4-1.7-5.7-2.9l-.4-.3v9.9l.2.1c1.5.7 3.3 1.2 5.4 1.7 2.2.4 4.1.7 5.8.7 5.2 0 9.5-1.2 12.5-3.7 3.1-2.5 4.7-5.7 4.7-9.8 0-2.9-.8-5.4-2.5-7.4-1.8-2-4.7-3.8-8.7-5.4M267.6 22.9c-7.1 0-12.7 2.1-16.7 6.2s-6 9.8-6 16.9c0 6.7 2 12.1 5.9 16.1 3.9 3.9 9.2 5.9 15.8 5.9 6.9 0 12.4-2.1 16.4-6.3 4-4.2 6-9.8 6-16.7 0-6.8-1.9-12.3-5.7-16.2-3.8-3.9-9.1-5.9-15.7-5.9m8 33.1c-1.9 2.4-4.8 3.6-8.5 3.6s-6.6-1.2-8.7-3.7c-2.1-2.4-3.1-5.9-3.1-10.3 0-4.6 1.1-8.1 3.1-10.6 2.1-2.5 5-3.7 8.6-3.7 3.5 0 6.4 1.2 8.4 3.6 2 2.4 3.1 5.9 3.1 10.5s-1 8.2-2.9 10.6"/><path d="M342.9 32.2v-8.2h-10.2v-12.9l-.3.1-9.6 2.9-.2.1v9.7h-15.2v-5.4c0-2.5.6-4.4 1.7-5.7 1.1-1.3 2.7-1.9 4.7-1.9 1.4 0 2.9.3 4.5 1l.4.2v-8.7l-.2-.1c-1.4-.5-3.3-.8-5.7-.8-3 0-5.7.7-8.1 1.9-2.4 1.3-4.2 3.1-5.5 5.5-1.3 2.3-2 5-2 8v6h-7.2v8.2h7.1v34.8h10.2v-34.7h15.2v22.1c0 9.1 4.3 13.7 12.8 13.7 1.4 0 2.9-.2 4.3-.5 1.5-.3 2.6-.7 3.2-1l.1-.1v-8.3l-.4.3c-.6.4-1.2.7-2.1.9-.8.2-1.5.3-2 .3-2 0-3.4-.5-4.4-1.6-.9-1.1-1.4-2.9-1.4-5.5v-20.3h10.3z"/></g></svg>
				</a>
			</div>
			<div id="copyright">
				© 2019 Microsoft
			</div>
		</div>
	</div><!-- .site-info -->
</footer><!-- .site-footer -->

</div><!-- .site -->

	<script type="text/javascript">
	jQuery(document).ready(function($){
		$login_link = $( 'a[href*="wp-login.php?"]' );
				$login_link.on( 'click', function( evt ) {
			// evt.preventDefault();
						// console.log( 'cookie-set', '/sqlexpress/2011/12/08/using-localdb-with-full-iis-part-1-user-profile/' );
			$.cookie( 'aadsso-redirect', '/sqlexpress/2011/12/08/using-localdb-with-full-iis-part-1-user-profile/', { expires: 1, path: '/' });
		});
	});
	</script>
		<script>
		jQuery(window).load(function () {
			// Fix Bug #644092:MAS36: Page number
			jQuery('div.nav-links>a.page-numbers').each(function(){
				jQuery(this).attr('aria-label', 'Page ' + jQuery(this).html());
			});

			// Fix Bug #633981:MAS20B:  Talkback: Talkback announces link for Number of Comments as 'Number link'
			jQuery('span.comments-link>a').each(function () {
				var num = parseInt(jQuery(this).html());
				if (isNaN(num)) {
					return false;
				}
				var content = num + (num === 1 ? ' comment' : ' comments');
				jQuery(this).attr({
					'aria-label': content,
					'title': content
				});
			});


			jQuery('#search-option>div').each(function () {
				jQuery(this).attr('aria-label',jQuery('span.search-text',this).html());
			});

			// Fix Bug #671896:MAS40B :Inspect: Header: "Name" property is not descriptive for  "Microsoft | TechNet" link (logo).
			var currentHost = location.hostname;
			if (currentHost.indexOf('msdn') !== -1) {
				jQuery('#home-link').attr('aria-label','Microsoft Developer');
			} else if (currentHost.indexOf('technet') !== -1) {
				jQuery('#home-link').attr('aria-label','Microsoft Technet');
			}

			// Detect High Contrast Mode in non IE/Edge Browsers
			jQuery('html').css('background-image', 'url("data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==")');
			if (jQuery('html').css('background-image') === 'none') {
				jQuery('html').attr('data-high-contrast', 'true');
			}

			// Fix Bug #670327:MAS40B: Inspect: Header: "Localized control type" property is incorrect for the header elements.
			// Fix Bug #683788:MAS40B: TalkBack: Header: For menu items in technet link menu bar, expand/collapse pattern available, is not announced by TalkBack 
			jQuery('#site-navigation>div>ul>li>a').attr('role', 'button').attr('aria-expanded', 'false').click(function () {
				if (jQuery(this).attr('aria-expanded') === 'true') {
					jQuery(this).attr('aria-expanded', 'false');
				} else {
					jQuery(this).attr('aria-expanded', 'true');
				}
			});

		});
	</script>
		<!--ADD WEDCS SCRIPT-->
	<div id="_WEDCSInsertedData" style="display: none;"></div>
	<script type="text/javascript">
		jQuery( window ).load(
			function() {
				window.varSegmentation = 0;
				window.varClickTracking = 1;
				window.varCustomerTracking = 1;
				window.varAutoFirePV = 1;
				window.Route = ""; // was 23470 in the windows theme framework
				window.Ctrl = "";

								var blogPost = {};

								blogPost.permalink = 'https://blogs.msdn.microsoft.com/sqlexpress/2011/12/08/using-localdb-with-full-iis-part-1-user-profile/';
				blogPost.title = 'Using LocalDB with Full IIS, Part 1: User Profile';
				blogPost.author = 'sqlexpress';
				blogPost.post_date = '2011-12-08 23:14:00';
				blogPost.category = 'Uncategorized';
				blogPost.tag = '';
				blogPost.comment_number = '26';
								window.blogPost = blogPost;

                var wedcs_script = document.createElement('script');
                wedcs_script.type = 'text/javascript';
                wedcs_script.async = true;
                wedcs_script.src = 'https://blogs.msdn.microsoft.com/sqlexpress/wp-content/mu-plugins/wedcs-script/ms2_blogs.js';
                if (typeof mscc === 'undefined' || (!mscc || mscc.hasConsent())) {
                    document.getElementsByTagName('body')[0].appendChild(wedcs_script);
                }

				var script_jsll = document.createElement("script");
				script_jsll.type = "text/javascript";
				script_jsll.src = "//az725175.vo.msecnd.net/scripts/jsll-4.2.1.js";
				script_jsll.onload = function () {
					var domainAppIdDic = {
						"blogs.msdn.microsoft.com": "blogsmsdn",
						"blogs.technet.microsoft.com": "blogstechnet"
					};
					var domain = document.domain;
					var appId = "blogsmsdn";
					if (domainAppIdDic[domain]) {
						appId = domainAppIdDic[domain];
					}
					var config = {
						coreData: {
							appId: appId
						}
					};
					awa.init(config);
				};
				if (document.getElementsByTagName("head") && document.getElementsByTagName("head").length > 0) {
					document.getElementsByTagName("head")[0].appendChild(script_jsll);
				}
			});
	</script>
	<!--
	<script src="//c.microsoft.com/ms.js" type="text/javascript"></script>
	<noscript><img alt="" width="1" height="1" src="http://c.microsoft.com/trans_pixel.aspx"/></noscript>
	-->
		<script type="text/javascript">
			jQuery( window ).load(
				function () {
					var stylesheet = document.createElement('link');
					stylesheet.href = 'https://blogs.msdn.microsoft.com/sqlexpress/wp-content/plugins/simple-follow-me-social-buttons-widget/assets/css/style.css?ver=3.3.3';
					stylesheet.rel = 'stylesheet';
					stylesheet.type = 'text/css';
					document.getElementsByTagName('head')[0].appendChild(stylesheet);
				});
		</script>
				<script type="text/javascript">
			jQuery( window ).load(
				function () {
					var stylesheet = document.createElement('link');
					stylesheet.href = 'https://blogs.msdn.microsoft.com/sqlexpress/wp-content/plugins/simple-follow-me-social-buttons-widget/assets/css/icons.css?ver=3.3.3';
					stylesheet.rel = 'stylesheet';
					stylesheet.type = 'text/css';
					document.getElementsByTagName('head')[0].appendChild(stylesheet);
				});
		</script>
				<script type="text/javascript">
			jQuery( window ).load(
				function () {
					var script = document.createElement('script');
					script.src = 'https://blogs.msdn.microsoft.com/sqlexpress/wp-content/plugins/simple-follow-me-social-buttons-widget/assets/js/front-widget.js?ver=3.3.3';
					script.type = 'text/javascript';
					script.async = true;
					document.getElementsByTagName('body')[0].appendChild(script);
				});
		</script>
		
		<span id='page-view-tracking-info' blog-id='43' post-id='144'></span>
		<script type="text/javascript">
			// Check for compatibility before IE8
			if (!Date.now) {
 				 Date.now = function() { return new Date().getTime(); };
			}
			jQuery( window ).load( function() {
				jQuery.ajax({
					url: 'https://blogs.msdn.microsoft.com/sqlexpress/wp-admin/admin-ajax.php',
					type: 'get',
					data: {
						action: 'track_page_view',
						track_page_view_post_id: jQuery('#page-view-tracking-info').attr('post-id'),
						track_page_view_blog_id: jQuery('#page-view-tracking-info').attr('blog-id'),
						track_page_view_post_url: window.location.href.split('?')[0],
						timestamp: Date.now()
						}
				});
			});
		</script>
<script>
dataLayer = [[]];
</script>
<!-- Google Tag Manager -->
<noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-PLR87W" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<script>jQuery(window).load(function(){(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&amp;l='+l:'';j.async=true;j.src=
'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-PLR87W')});
</script>
<!-- End Google Tag Manager -->
	<script type="text/javascript">
		jQuery( window ).load(
			function(i) {
				var n = window,
					t = document,
					e = n.console,
					f, u, r, o;
				typeof e == "undefined" && (f = function() {}, e = {
					log: f,
					warn: f,
					assert: f,
					clear: f,
					dir: f,
					error: f,
					info: f,
					profile: f,
					profileEnd: f
				}), u = {
					appendToHead: function(n) {
						if (t.getElementsByTagName("head").length > 0) t.getElementsByTagName("head")[0].appendChild(n);
						else throw "bootstrapper: no head element found.";
					},
					appendToBody: function(n) {
						if (t.getElementsByTagName("body").length > 0) t.getElementsByTagName("body")[0].appendChild(n);
						else throw "bootstrapper: no body element found.";
					},
					addStyleElement: function(n) {
						var i = t.createElement("link");
						i.setAttribute("href", n), i.setAttribute("rel", "stylesheet"), i.setAttribute("type", "text/css"), u.appendToHead(i)
					},
					loadFiles: function(n, t) {
						if (t !== i && u.recursiveScriptLoad(0, t), n !== i)
							for (var r = 0, r = 0; r < n.length; r++) u.addStyleElement(n[r])
					},
					recursiveScriptLoad: function(n, t) {
						t[n] && u.addScriptElement(t[n], function() {
							u.recursiveScriptLoad(n + 1, t)
						})
					},
					isCompatible: function(n, t) {
						var r, u, i;
						return (r = n.split("."), u = t.split("."), i = function(n) {
							return isNaN(n) ? 0 : n
						}, i(r[0]) > i(u[0]) || i(r[0]) === i(u[0]) && i(r[1]) > i(u[1]) || i(r[0]) === i(u[0]) && i(r[1]) === i(u[1]) && i(r[2]) >= i(u[2])) ? !0 : !1
					},
					addScriptElement: function(i, r) {
						var f, e;
						f = t.createElement("script"), f.setAttribute("type", "text/javascript"), f.async = true, f.setAttribute("src", i), f.attachEvent ? (e = function() {
							setTimeout(function() {
								typeof n.jQuery != "undefined" && r ? r() : e()
							}, 10)
						}, e()) : f.onload = r, u.appendToBody(f)
					},
					load: function(n, t) {
						setTimeout(function() {
							if (typeof n == "undefined") try {
								u.addScriptElement(t.defaultPath, function() {
									u.loadFiles(t.cssFiles, t.jsFiles)
								});
								return
							} catch (i) {
								e.warn("bootstrapper: failed to load default jQuery")
							} else if (!u.isCompatible(n.fn.jquery, t.minimumVersion)) {
								e.warn("bootstrapper: jQuery version is too old to load UserCard. Use v1.4.2 or later.");
								return
							}
							u.loadFiles(t.cssFiles, t.jsFiles)
						}, 0)
					}
				}, r = {
					host: n.location.host,
					search: "",
					protocol: "https"
				}, r.host = "widgets.services.microsoft.com", r.search = "?brand=msdn&lang=en&ver=4.9.0.0", r.protocol = "https:", o = {
					minimumVersion: "1.1.2",
					defaultPath: "https://code.jquery.com/jquery-1.4.2.min.js",
					cssFiles: [r.protocol + "//" + r.host + "/v1/UnifiedBaseballCard.css" + r.search, r.protocol + "//" + r.host + "/v1/usercard.css" + r.search],
					jsFiles: ["https://ajax.aspnetcdn.com/ajax/jquery.templates/beta1/jquery.tmpl.min.js", r.protocol + "//" + r.host + "/v1/jquery.timeago.js" + r.search, r.protocol + "//" + r.host + "/v1/jquery.textfill.js" + r.search, r.protocol + "//" + r.host + "/v1/widgets.js" + r.search]
				}, typeof n.jQuery == "undefined" ? u.load(i, o) : u.load(n.jQuery, o)
			}
		);
	</script>
<link rel='stylesheet' id='eucookielaw-css-css'  href='https://c.s-microsoft.com/mscc/statics/mscc-0.4.1.min.css?ver=4.9.10' type='text/css' media='all' />
<script type='text/javascript'>
/* <![CDATA[ */
var wpAjax = {"noPerm":"Sorry, you are not allowed to do that.","broken":"Something went wrong."};
/* ]]> */
</script>
<script type='text/javascript' src='https://blogs.msdn.microsoft.com/sqlexpress/wp-includes/js/wp-ajax-response.min.js?ver=4.9.10'></script>
<script type='text/javascript' src='https://blogs.msdn.microsoft.com/sqlexpress/wp-content/plugins/msdn-delete-comment/msdn-delete-comment-script.js?ver=20180311'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var wds_ratings_config = {"ajaxurl":"https:\/\/blogs.msdn.microsoft.com\/sqlexpress\/wp-admin\/admin-ajax.php","user_id":"0","nonce":"c2d4c7b0d4","debug":"","no_auth_alert":"You must be logged in to rate this article.","repeatedly_vote_alert":"You can not vote repeatedly in a short time","allow_anonymous_rating":"","blog_id":"43","rating_limit_login_user":"1","rating_limit_anonymous":"1","hide_rating_post_ids":""};
var wds_ratings_config = {"ajaxurl":"https:\/\/blogs.msdn.microsoft.com\/sqlexpress\/wp-admin\/admin-ajax.php","user_id":"0","nonce":"c2d4c7b0d4","debug":"","no_auth_alert":"You must be logged in to rate this article.","repeatedly_vote_alert":"You can not vote repeatedly in a short time","allow_anonymous_rating":"","blog_id":"43","rating_limit_login_user":"1","rating_limit_anonymous":"1","hide_rating_post_ids":""};
/* ]]> */
</script>
<script type='text/javascript' src='https://blogs.msdn.microsoft.com/sqlexpress/wp-content/plugins/wds-ratings/wds-ratings.js?ver=20161014'></script>
<script type='text/javascript' src='https://blogs.msdn.microsoft.com/sqlexpress/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1'></script>
<script type='text/javascript' src='https://blogs.msdn.microsoft.com/sqlexpress/wp-content/themes/microsoft/js/theme-merged.js?ver=02092017'></script>
<script type='text/javascript' src='https://blogs.msdn.microsoft.com/sqlexpress/wp-includes/js/wp-embed.min.js?ver=4.9.10'></script>
<script type='text/javascript' src='https://c.s-microsoft.com/mscc/statics/mscc-0.4.1.min.js?ver=4.9.10'></script>
<script type='text/javascript' src='https://blogs.msdn.microsoft.com/sqlexpress/wp-content/plugins/eu-cookie-law/eucookielaw-searchbox-script.js?ver=4.9.10'></script>
<script type='text/javascript' src='https://blogs.msdn.microsoft.com/sqlexpress/wp-content/themes/microsoft/js/vendor/jquery.cookie.js?ver=11092015'></script>

</body>
</html>
